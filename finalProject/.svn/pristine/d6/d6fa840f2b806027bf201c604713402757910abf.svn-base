<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.chatting.mapper.ChatMapper">

<!-- 1. 방생성 -->
<insert id="insertRoom" parameterType="kr.or.ddit.chatting.vo.ChatRoomVO">
	<selectKey resultType="int" order="BEFORE" keyProperty="roomNo">
		SELECT CHAT_ROOM_SEQ.NEXTVAL FROM DUAL
	</selectKey>
			INSERT ALL
			    
			    INTO CHAT_ROOM(ROOM_NO  ,   ROOM_NAME  , CREATE_DATE , USER_ID)
			            VALUES(#{roomNo},  #{roomName} , SYSDATE     , #{userId})
			    
			    INTO CHAT_RELAY(USER_ID, ROOM_NO)
			    VALUES(#{userId} , #{roomNo})
			    
			SELECT * FROM DUAL
</insert>

<!-- 채팅방 목록 불러오기 -->
<select id="chatRoomList" resultType="kr.or.ddit.chatting.vo.ChatRoomVO">
	SELECT ROOM_NO, ROOM_NAME, CREATE_DATE, USER_ID, JOIN_USER
	FROM CHAT_ROOM
	ORDER BY ROOM_NO DESC
</select>


<!-- <insert> -->
<!-- 	INSERT ALL -->
			    
<!-- 			    INTO CHAT_ROOM(ROOM_NO  ,   ROOM_NAME  , CREATE_DATE , CREATE_USER) -->
<!-- 			            VALUES(#{roomNo},  #{roomName} , SYSDATE     , #{createUser}) -->
			    
<!-- 			    INTO CHAT_RELAY(USER_ID, ROOM_NO) -->
<!-- 			    VALUES(#{createUser} , #{roomNo}) -->
			    
<!-- 			SELECT * FROM DUAL -->

<!-- </insert> -->
<!-- <insert id = insertRoom2 parameterType="hashMap"> -->
<!-- 	<selectKey resultType="int" order="BEFORE" keyProperty="roomNo"> -->
<!-- 		SELECT CHAT_ROOM_SEQ.NEXTVAL FROM DUAL -->
<!-- 	</selectKey> -->
<!-- 	INSERT ALL -->
<!-- 		 INTO CHAT_ROOM(ROOM_NO  ,   ROOM_NAME  , CREATE_DATE , CREATE_USER) -->
<!--             VALUES(#{roomNo},  #{roomName} , SYSDATE     , #{createUser}) -->
		
<!-- 		INTO CHAT_RELAY(USER_ID , ROOM_NO) -->
<!-- 		VALUES(#{createUser) , #{roomNo) -->
<!-- </insert> -->
<!-- 	<resultMap type="kr.or.ddit.chatting.vo.ChatRoomVO" id = "chatRoomVO"> -->
<!-- 		<result property = "createUser" column="userId" /> -->
<!-- 	</resultMap> -->
<!-- 		<select id="choice" parameterType="String" resultType="hashMap"> -->
<!-- 			SELECT  -->
<!-- 		</select> -->

<!-- 		<resultMap type="chatRoomVO" id="chatRoomVO"> -->
<!-- 			<result property="cnt" column="cnt"/> -->
<!-- 			<result property="emplyrTy" column="emplyrTy"/> -->
<!-- 			<result property="userNcnm" column="userNcnm"/> -->
<!-- 		</resultMap> -->
<!-- 		<select id="memberLogin" parameterType="hashMap" resultMap="usersMap"> -->
<!-- 			SELECT USER_ID AS userId, COUNT(*) AS cnt, EMPLYR_TY AS emplyrTy, USER_NCNM AS userNcnm -->
<!-- 			FROM USERS -->
<!-- 			WHERE USER_ID=#{userId} AND USER_PASSWORD=#{userPassword} -->
<!-- 			GROUP BY EMPLYR_TY, USER_NCNM, USER_ID -->
<!-- 		</select> -->

</mapper>