<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>

<script type="text/javascript">
$(function() {
	
	$("#uploadFile").on("change",handleImgFileSelect);
	function handleImgFileSelect(e){
		let files = e.target.files;
		

		console.log(files);
		let fileArr = Array.prototype.slice.call(files);
	
		fileArr.forEach(function(f){
		
			console.log(f);
			if(!f.type.match("image.*")){
				alert("이미지 파일만 가능합니다.");
				return;
			}
		
			let reader = new FileReader();
			
			$(".clsCiImgUrl").html("");
			
			reader.onload = function(e){
				$(".clsCiImgUrl").css({
			          "background-image": "url(" + e.target.result + ")",
			          "background-position": "center",
			          "background-size": "cover",
			          "width": "300px", 
			          "height": "200px",
			          "border": "1px solid #ccc"
			        });				
			}
			reader.readAsDataURL(f);
		});
	}
	
	
	
	
});
</script>
<h2>오늘 모임 등록</h2>
<div class="card">
    <div class="card-body">
        <h4 class="card-title"></h4>
        <p class="card-description">         
        </p>
        <form action="/todayMeeting/create" class="forms-sample" method="post" enctype="multipart/form-data">
    <div class="form-group">
                <label for="tdmtngNm">모임명</label>
                <input type="text" class="form-control" id="tdmtngNm" name="tdmtngNm" required>
            </div>

            <div class="form-group">
                <label for="tdmtngDt">모임일시</label>
                <input type="datetime-local" class="form-control" id="tdmtngDt" name="tdmtngDt" placeholder="Password">
            </div>
            
            <div class="form-group">
                <label for="tdmtngCn">모임내용</label>
                <textarea class="form-control" rows="10" id="tdmtngCn" name="tdmtngCn"></textarea>
            </div>
            <!-- 업로드 버튼을 눌러도 아무 반응이 없어서 js파일 확인해 봤으나 문제가 없었음
            tiles에 <script src="/resources/skydash/js/dashboard.js"></script> 추가
             -->
             
             <div
				class="clsCiImgUrl  col-xs-12">
				<h3>이미지 미리보기</h3>
			</div>        
            <div class="form-group">
                <label>이미지 파일</label>
                <input type="file" id="uploadFile" name="uploadFile" class="file-upload-default">
                <div class="input-group col-xs-12">
                    <input type="text" class="form-control file-upload-info" disabled="" placeholder="파일선택">
                    <span class="input-group-append">
                        <button class="file-upload-browse btn btn-primary" type="button">업로드</button>
                    </span>
                </div>
            </div>

            <button type="submit" class="btn btn-primary mr-2">등록</button>
            <button class="btn btn-light">취소</button>
        </form>
    </div>
</div>

<!-- 
	<script type="text/javascript">
ClassicEditor.create(document.querySelector('#ckCiMesg'),
		{ckfinder:{uploadUrl:'/upload/uploads?${_csrf.parameterName}=${_csrf.token}'}})
 .then(editor=>{window.editor=editor;})
 .catch(err=>{console.error(err.stack);});
</script>
 -->
