<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
<title></title>
</head>
<script  type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript">

$(function(){
	
	   $("#btnSearch").on("click",function(){
		      let keyword = $("input[name='keyword']").val();
		      
		      console.log("keyword:"+keyword);
		      
		      let currentPage = "1";
		      
		      let data = {
		         "keyword":keyword,
		         "currentPage":currentPage
		      };
		      console.log("data:"+data)
		      
		      $.ajax({
		         url:"/proCprtnBbsctt/listAjax",
		         contentType:"application/json;charset=utf-8",
		         data:JSON.stringify(data),
		         type:"post",
		         dataType:"json",
		         success:function(result){
		            console.log("result:",result);
		            
		            let str = "";
		            
		            $("#proCprtnBbscttTbody").html("");
		         
		            $.each(result.content,function(idx, proCprtnBbscttVO){
 		               str += "<tr onclick=\"location.href='/proCprtnBbsctt/detail?proCprtnBbscttNo=" + proCprtnBbscttVO.proCprtnBbscttNo + "'\" style=\"cursor: pointer;\">";
		               //str += "<tr>";
		               str += "<td>"+proCprtnBbscttVO.rnum+"</td>";		   
		               str += "<td>"+proCprtnBbscttVO.proCprtnBbscttSj+"</td>";
		               str += "<td>"+new Date(proCprtnBbscttVO.proCprtnBbscttWrDt).toLocaleString()+"</td>";
		               str += "<td>"+proCprtnBbscttVO.proCprtnBbscttRdcnt+"</td>";
		               str += "<td>"+proCprtnBbscttVO.proId+"</td>";
		               str += "</tr>";
		            
		            });   
		            
		            $("#proCprtnBbscttTbody").append(str);
		            $("#divPagingArea").html(result.pagingArea);
		            
		            
		         }
		         
		      });
		      
		   });
	
	   let currentPage  = "${param.currentPage}";
	   console.log("currentPage",currentPage);
	   if(currentPage==""){
	      currentPage = 1;
	      
	   }
	   
	   let data = {
	      "keyword":"${param.keyword}",
	      "currentPage":currentPage
	   };
	   console.log("data:",data);
	   
	   $.ajax({
	      url : "/proCprtnBbsctt/listAjax?currentPage="+currentPage,
	      type : "post",
	      data : JSON.stringify(data),
	      contentType: "application/json;charset=utf-8",
	      dataType:"json",
	      success : function(result){
	         console.log("result:",result);
	      
	         let str = "";
	         
	         $("#proCprtnBbscttTbody").html("");
	         
	         $.each(result.content,function(idx, proCprtnBbscttVO){

 	        	   str += "<tr onclick=\"location.href='/proCprtnBbsctt/detail?proCprtnBbscttNo=" + proCprtnBbscttVO.proCprtnBbscttNo + "'\" style=\"cursor: pointer;\">";
				   //str += "<tr>";
	               str += "<td>"+proCprtnBbscttVO.rnum+"</td>";		   
	               str += "<td>"+proCprtnBbscttVO.proCprtnBbscttSj+"</td>";
	               str += "<td>"+new Date(proCprtnBbscttVO.proCprtnBbscttWrDt).toLocaleString()+"</td>";
	               str += "<td>"+proCprtnBbscttVO.proCprtnBbscttRdcnt+"</td>";
	               str += "<td>"+proCprtnBbscttVO.proId+"</td>";
	               str += "</tr>";
	            
	            
	         });
	         $("#proCprtnBbscttTbody").append(str);
	         console.log(result.pagingArea);
	         $("#divPagingArea").html(result.pagingArea);
	         
	         
	         sessionStorage.setItem("total",result.total);
	      }
	      
	   });
	   
	   
	   
});



</script>
<body>	

	<div class="col-lg-12 grid-margin stretch-card">
		<div class="card">
			<div class="card-body">
				<div class="row">
					<div class="col-md-6" style="margin-top: 10px;">
						<h3>프로협업게시판</h3>
					</div>
					<div class="col-md-6 form-group text-center">
                    <div class="input-group">
                        <input type="text" name="keyword" id="keyword" value="${param.keyword}" class="form-control" placeholder="검색어를 입력하세요" aria-label="">
                        <div class="input-group-append">
                            <button class="btn btn-sm btn-primary" id="btnSearch" type="button">
                                Search <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
			</div>
		

				<div class="table-responsive">
					<table class="table table-hover">
						<thead>
							<tr class="text-white" style="background-color: #4b49ac">
								<th style="width:10%">글번호</th>
								<th style="width:50%">게시글제목</th>
								<th style="width:10%">작성일자</th>
								<th style="width:10%">조회수</th>
								<th style="width:10%">작성자</th>
								
							</tr>
						</thead>
						
						 <tbody id="proCprtnBbscttTbody"> 
						 </tbody>
						
					
						
					</table>
				</div>			
				<div class="row justify-content-center" style="margin-top: 20px;">
					<div class= "row" id="divPagingArea"></div>
				</div>
			</div>
		</div>
	</div>
	

<a href="/proCprtnBbsctt/create" class="btn btn-inverse-primary btn-fw">글쓰기</a>
</body>
</html>