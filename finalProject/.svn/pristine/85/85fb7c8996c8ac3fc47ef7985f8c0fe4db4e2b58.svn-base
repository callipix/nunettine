<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript">
$(function() {
	
	$("#btnRvEdit").on("click", function() {
		$(".rvDetail").removeAttr("readonly");
		
		$("#btnsUpdate").css("display", "none");
		$("#btnsCkUpdate").css("display", "block");
		
		$("#uploadFile").on("change",handleImgFileSelect);
// 		function handleImgFileSelect(e){
// 			//이벤트가 발생 된 타겟 안에 들어있는 이미지 파일들을 가져와보자
// 			let files = e.target.files;
			

// 			console.log(files);
// 			let fileArr = Array.prototype.slice.call(files);
		
// 			fileArr.forEach(function(f){
// 				//이미지 파일이 아닌 경우 이미지 미리보기 실패 처리(MIME타입)
				
// 				console.log(f);
// 				if(!f.type.match("image.*")){
// 					alert("이미지 파일만 가능합니다.");
// 					//함수 종료
// 					return;
// 				}
// 				//이미지 객체를 전역 배열타입 변수에 넣자
// 				//이미지 객체를 읽을 자바스크립트의 reader 객체 생성
// 				let reader = new FileReader();
				
// 				$(".clsCiImgUrl").html("");
				
// 				//e : reader가 이미지 객체를 읽는 이벤트
// 				reader.onload = function(e){
// 					$(".clsCiImgUrl").css({
// 				          "background-image": "url(" + e.target.result + ")",
// 				          "background-position": "center",
// 				          "background-size": "cover",
// 				          "width": "300px", 
// 				          "height": "200px",
// 				          "border": "1px solid #ccc"
// 				    });
// //	 				
// 				}
// 				//f : 이미지 파일 객체를 읽은 후 다음 이미지 파일(f)을 위해 초기화 함
// 				reader.readAsDataURL(f);
// 			});//end forEach
// 		}
		
	})
	
	
	
	$("#btnRvList").on("click", function() {
		location.href = "/reviewBoard/main";
	})
	$("#btnRvDel").on("click", function() {
		let aftusBbscttNo = $("#aftusBbscttNo").val();
		Swal.fire({
			title: '정말 삭제 하시겠습니까?',
			icon: 'warning',
			showCancelButton: true,
			confirmButtonText: '확인',
	        cancelButtonText: '취소',
	        reverseButtons: false,
		}).then((result) => {
			if (result.isConfirmed) {
				$.ajax({
					url: "/reviewBoard/delete",
					type: "post",
					data: {"aftusBbscttNo" : aftusBbscttNo},
					success: function(result) {
						Swal.fire({
							title: '삭제가 완료 됐습니다.',
							icon: 'confirm',
			            	confirmButtonText: '확인',
						}).then((result) => {
							location.href = "/reviewBoard/main";
						})
						
					}
				
				})
			}
		})

		/* location.href = "/reviewBoard/delete?aftusBbscttNo=" + ${aftusBbscttVO.aftusBbscttNo} */
	})
	
})
</script>

<div class="card">
    <div class="card-body">
        <p></p>
        <form action="" class="forms-sample" name="tmtUpdate" method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label for="aftusBbscttNo">번호</label>
				<input type="text" class="form-control" id="aftusBbscttNo" name="aftusBbscttNo" value="${aftusBbscttVO.aftusBbscttNo}" readonly>
			</div>
            <div class="form-group">
                <label for="aftusBbscttSj">제목</label>
                <input type="text" class="form-control rvDetail" id="aftusBbscttSj" name="aftusBbscttSj" value="${aftusBbscttVO.aftusBbscttSj}" readonly>
            </div>
            <div class="form-group">
            	<label for="userNcnm">작성자</label>
				<input type="text" class="form-control" id="userNcnm" name="userNcnm" value="${aftusBbscttVO.userNcnm}" readonly>
            </div>
            <div class="form-group">
                <label for="aftusBbscttWrDt">작성일자</label>
				<input type="text" class="form-control" id="aftusBbscttWrDt" name="aftusBbscttWrDt" value="${aftusBbscttVO.aftusBbscttWrDt}" readonly>
            </div>
            <div class="form-group">
            	<label for="aftusBbscttRdcnt">조회수</label>
				<input type="text" class="form-control" id="aftusBbscttRdcnt" name="aftusBbscttRdcnt" value="${aftusBbscttVO.aftusBbscttRdcnt}" readonly>
            </div>
            
            <div class="form-group">
            	<label for="srvcRequstNo">서비스 요청 번호</label>
				<input type="text" class="form-control" id="srvcRequstNo" name="srvcRequstNo" value="${aftusBbscttVO.srvcRequstNo}" readonly>
            </div>
            
            
            <div class="form-group">
       			<label for="aftusBbscttCn">내용</label>
        		<div id="ckEditor">${aftusBbscttVO.aftusBbscttCn}</div>
       			<textarea class="form-control" rows="10" id="aftusBbscttCn" name="aftusBbscttCn" style="display: none;"></textarea>
      		</div>
            

<!--             <div class="form-group"> -->
<!--                 <label for="aftusBbscttCn">후기내용</label> -->
<%--                 <textarea class="form-control rvDetail" rows="10" id="aftusBbscttCn" name="aftusBbscttCn" readonly>${aftusBbscttVO.aftusBbscttCn} --%>
<!--                 </textarea> -->
<!--             </div> -->
         

<!--        		<div id="imgPreDiv" class="clsCiImgUrl  col-xs-12" style="display: none;"> -->
<!-- 			</div> -->
             
       	
            <div id="imgUpDiv" class="form-group" style="display: none;">
                <label>이미지 파일</label>
                <input type="file" id="uploadFile" name="uploadFile" class="file-upload-default" >
                <div class="input-group col-xs-12">
                    <input type="text" class="form-control file-upload-info" disabled="" placeholder="파일선택">
                    <span class="input-group-append">
                        <button class="file-upload-browse btn btn-primary" type="button">업로드</button>
                    </span>
                </div>
            </div>
            <div id="btnsUpdate">
            	<button type="button" id="btnRvEdit" class="btn btn-primary mr-2">수정</button>
            	<button type="button" id="btnRvDel" class="btn btn-primary mr-2">삭제</button>
            	<button type="button" class="btn btn-light" id="btnRvList">목록</button>
            </div>
            <div id="btnsCkUpdate" style="display: none;">
				<button type="submit" id="btnRvCkEdit" class="btn btn-primary mr-2">확인</button>
				<button type="button" id="btnRvCancel" class="btn btn-light">취소</button>
			</div>
            
        </form>
    </div>
</div>