<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
<title></title>
</head>
<script>
$(document).ready(function(){
    console.log("지역코드를 이름으로");
    var bcityCode = $("#bcityCode").val();
    var brtcCode = $("#brtcCode").val();
    console.log("bcityCode : " + bcityCode + ", brtcCode : " + brtcCode);
    
    // AJAX 호출 후 지역 코드를 이름으로 변경
	 $.ajax({
	    url: "/proProfl/getNm",
	    data: { "bcityCode": bcityCode, "brtcCode": brtcCode },
	    type: "post",
	    dataType: "json",
	    success: function(data) {
	        console.log("bcityNm : " + data.bcityNm +", brtcNm : " + data.brtcNm);
	        $("#bcityCode").text(data.bcityNm); 
	        $("#brtcCode").text(data.brtcNm); // 옵션의 텍스트 변경
	    },
	});

    // #bcityNm의 값이 변경될 때마다 호출됨
    $("#bcityNm").change(function(){
        var selecBcity = $(this).val(); // 선택된 광역시 이름
        var brtcOptions = ""; // 시/구 옵션을 저장할 변수
        
        // AJAX 호출 후 시/구 목록 업데이트
        $.ajax({
            type: "GET",
            url: "/proProfl/brtcList",
            data: { bcityNm: selecBcity },
            success: function(data){
                $.each(data, function(index, list){
                     brtcOptions += '<option value="' + list.brtcNm + '">' + list.brtcNm + '</option>';
                });
                $("#brtcNm").html('<option selected>지역(시/구)</option>' + brtcOptions);
            },
            error: function(xhr, status, error) {
                console.log("Error: " + error);
            }
        });
    });
});
</script>
<p>${proProflVO}</p>

<c:if test="${memSession == null && proSession != null}">
<form action="/proProfl/modifyProfl?proId=${proProflVO.proId}" method="get">
	<div class="mb-3"> 
		<div class="form-group">
 			<img src="${proVO.proProflPhoto}">		
		</div>
      <div class="form-group">
         <label for="proId">프로 아이디</label>
         <input type="text" name="proId" id="proId" value="${proProflVO.proId}" class="form-control" readonly/>
      </div>
      <div class="form-group">
         <label for="proProflOnLiIntrcn">한줄소개</label>
         <input type="text" name="proProflOnLiIntrcn" id ="proProflOnLiIntrcn" value="${proProflVO.proProflOnLiIntrcn}" class="form-control" />
      </div>
      <div class="form-group">
          <label for="proProflContactPosblTime">연락 가능 시간</label>
          <input type="text" name="proProflContactPosblTime" id="proProflContactPosblTime" value="${proProflVO.proProflContactPosblTime}" class="form-control" />
      </div>
      <div class="form-group">
         <label for="proProflReqForm">요청서 양식</label>
         <input type="text" name="proProflReqForm" id="proProflReqForm" value="${proProflVO.proProflReqForm}" class="form-control" />
      </div>
      <div class="form-group">
         <label for="proProflHist">프로 이력</label>
         <input type="text" name="proProflHist" id="proProflHist" value="${proProflVO.proProflHist}" class="form-control" />
      </div> 
		<div class="form-group">
			<label for="bcityNm">지역(광역시)</label>
			   <select id="bcityNm" name="bcityNm" class="form-control">
			      <option selected id="bcityCode">${proProflVO.bcityCode}</option>
			      <c:forEach items="${bcityVOList}" var="bcityVO">
			         <option><c:out value="${bcityVO.bcityNm}"/></option>
			      </c:forEach>
			   </select>
		</div> 
		<div class="form-group">
			<label for="brtcNm">지역(시/구)</label>
				<select id="brtcNm" name="brtcNm" class="form-control">
				    <option id="brtcCode" selected>${proProflVO.brtcCode}</option>
				</select>
		</div>
		
      <div class="form-group">
         <input type="submit" class="btn btn-outline-primary btn-fw" value="수정하기">
         <button onclick="history.back()" class="btn btn-outline-secondary btn-fw">뒤로가기</button>
      </div>
</div>

</form>
</c:if>

