<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%-- <%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%> --%>
<script src="https://ssl.daumcdn.net/dmaps/map_js_init/postcode.v2.js"></script>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript" src="/resources/ckeditor5/ckeditor.js"></script>
<script type="text/javascript" src="/resources/js/bootstrap.bundle.js"></script>
<link type="text/css" rel="stylesheet"
	href="/resources/ckeditor5/sample/css/sample.css" media="screen" />
<style>
.form-control {
	background-attachment: local;
	background-image: linear-gradient(to right, white 10px, transparent 10px),
		linear-gradient(to left, white 10px, transparent 10px),
		repeating-linear-gradient(white, white 30px, #ccc 30px, #ccc 31px, white
		31px);
	line-height: 31px;
	padding: 8px 10px;
}
</style>
<script type="text/javascript">
//첨부파일 여러개 올리고 삭제하기
let selectedFiles = [];

function test(files) {
    console.log(files);
    const fileList = document.getElementById('file-list');
    for(let i=0; i<files.length; i++) {
        selectedFiles.push(files[i]);
        const item = document.createElement('div');
        const fileName = document.createTextNode(files[i].name);
        const deleteButton = document.createElement('button');
        deleteButton.addEventListener('click', (event) => {
            item.remove();
            event.preventDefault();
            deleteFile(files[i]);
        });
        deleteButton.innerText="X";
        item.appendChild(fileName);
        item.appendChild(deleteButton);
        fileList.appendChild(item);
    }
}

function deleteFile(deleteFile) {
    const inputFile = document.querySelector('input[name="files"]');
    const dataTransfer = new DataTransfer();
    selectedFiles = selectedFiles.filter(file => file!==deleteFile);
    selectedFiles.forEach(file => {
        dataTransfer.items.add(file);
    })
    inputFile.files = dataTransfer.files;
}
//===============================

// 첨부파일 삭제 버튼 이벤드
function fileDel(sprviseAtchmnflNo,atchmnflNo,statCount){
	console.log("sprviseAtchmnflNo : " + sprviseAtchmnflNo);
	console.log("atchmnflNo : " + atchmnflNo);
	console.log("statCount : " + statCount)
	
	let data = {
		"sprviseAtchmnflNo":sprviseAtchmnflNo,
		"atchmnflNo":atchmnflNo
	}
	console.log("data : ",data)
	
	$.ajax({
		url:"/lbrtybbsctt/fileDel",
		type:"post",		
		data:JSON.stringify(data),
		contentType:"application/json;chatset=utf-8",
		dataType:"text",
		success:function(res){
			console.log("fileDel->res : " + res);
			$("#fileDel"+statCount).hide();
		}
		
	});
}

//시간을 ..전으로 만들어주는 함수
function displayedAt(createdAt) {
  const milliSeconds = new Date() - createdAt
  const seconds = milliSeconds / 1000
  if (seconds < 60) return `방금 전`
  const minutes = seconds / 60
  if (minutes < 60) return `${Math.floor(minutes)}분 전`
  const hours = minutes / 60
  if (hours < 24) return `${Math.floor(hours)}시간 전`
  const days = hours / 24
  if (days < 7) return `${Math.floor(days)}일 전`
  const weeks = days / 7
  if (weeks < 5) return `${Math.floor(weeks)}주 전`
  const months = days / 30
  if (months < 12) return `${Math.floor(months)}개월 전`
  const years = days / 365
  return `${Math.floor(years)}년 전`
}

function ansAnsCnt(no){
$.ajax({
	url:"/lbrtybbsctt/ansAnsCnt",
	type:"post",
	data:JSON.stringify({
		"ptLbrtyBbscttAnswerNo":no
	}),
	contentType:"application/json;charset=utf-8",
	dataType:"text",
	success:function(res){
		console.log("cnt",res);
		$("#ansAnsViewBtn"+no).html("답글 "+ res + "개 ▼");
		$("#ansAnsViewBtn2"+no).html("답글 "+ res +"개  ▲");
		
		if(res==0){
			$("#ansAnsView"+no).hide();
		}else{
			$("#ansAnsView"+no).show();
		}
		
	}

});
}

function udtAns(no){
	console.log("수정");
	console.log(no);
	
	
	
	$("#lbrtyBbscttAnswerCn"+no).attr("readonly", false);
	console.log("#ansUdt"+no);
	console.log("#lbrtyBbscttAnswerCn"+no);
	
	$("#ansUdt"+no).show();
	$("#ansUdt"+no).on("click",function(){
		console.log("할룽");
		console.log($("#lbrtyBbscttAnswerCn"+no).val())
		let lbrtyBbscttAnswerCn = $("#lbrtyBbscttAnswerCn"+no).val();
		console.log(no);
		
		let data = {
			"lbrtyBbscttAnswerNo" : no,
			"lbrtyBbscttAnswerCn" : lbrtyBbscttAnswerCn
		}
		
		$.ajax({
			url:"/lbrtybbsctt/updataAns",
			type:"post",
			data:JSON.stringify(data),
			contentType:"application/json;charset=UTF-8",
			dataType:"text",
			success:function(res){
				console.log("res",res);
				listAns();
				$("#ansUdt"+no).hide();
				$("#lbrtyBbscttAnswerCn"+no).attr("readonly", true);
			}
		});
	});
	
	$("#ansUdt"+no).val()
	
}

//대댓글 수정
function udtAnsans(no){
	console.log("수정");
	console.log(no);
	
	$("#lbrtyBbscttAnswerCn"+no).attr("readonly", false);
	console.log("#ansUdt"+no);
	console.log("#lbrtyBbscttAnswerCn"+no);
	
	$("#ansUdt"+no).show();
	$("#ansUdt"+no).on("click",function(){
		console.log("할룽");
		console.log($("#lbrtyBbscttAnswerCn"+no).val())
		let lbrtyBbscttAnswerCn = $("#lbrtyBbscttAnswerCn"+no).val();
		console.log(no);
		
		let data = {
			"lbrtyBbscttAnswerNo" : no,
			"lbrtyBbscttAnswerCn" : lbrtyBbscttAnswerCn
		}
		
		$.ajax({
			url:"/lbrtybbsctt/updataAns",
			type:"post",
			data:JSON.stringify(data),
			contentType:"application/json;charset=UTF-8",
			dataType:"text",
			success:function(res){
				console.log("res",res);
				ansAnsViewBtn(no)
				$("#ansUdt"+no).hide();
				$("#lbrtyBbscttAnswerCn"+no).attr("readonly", true);
			}
		});
	});
	
	$("#ansUdt"+no).val()
	
}

//댓글 삭제
function delAns(no){
	console.log("삭제");
	console.log(no);
	let data = {
		"lbrtyBbscttAnswerNo": no
	}
	console.log("no : ", no);
	
	$.ajax({
		url:"/lbrtybbsctt/deleteAns",
		type:"post",
		data:JSON.stringify(data),
		contentType:"application/json;charset=utf-8",
		dataType:"text",
		success:function(res){
			console.log("res",res)
			listAns();
		}
	});
	
}

//대댓글 삭제
function delAnsans(lbrtyBbscttAnswerNo,ptLbrtyBbscttAnswerNo){
	console.log("삭제");
	console.log("넘어온 대댓글 번호 : ",lbrtyBbscttAnswerNo);
	console.log("넘어온 댓글 번호: ",ptLbrtyBbscttAnswerNo);
	let data = {
		"lbrtyBbscttAnswerNo": lbrtyBbscttAnswerNo
	}
	
	$.ajax({
		url:"/lbrtybbsctt/deleteAns",
		type:"post",
		data:JSON.stringify(data),
		contentType:"application/json;charset=utf-8",
		dataType:"text",
		success:function(res){
			console.log("res",res)
			$("#ansAnsView3"+lbrtyBbscttAnswerNo).hide();
			//여기서 필요한것은 38이라는 숫자입니다..
			ansAnsCnt(ptLbrtyBbscttAnswerNo);
			/* $.ajax({
				url:"/lbrtybbsctt/ansAnsCnt",
				type:"post",
				data:JSON.stringify({
					"ptLbrtyBbscttAnswerNo":ptLbrtyBbscttAnswerNo
				}),
				contentType:"application/json;charset=utf-8",
				dataType:"text",
				success:function(res){
					console.log(res)
					//ansAnsViewBtn238
					
					console.log($("#ansAnsView"+ptLbrtyBbscttAnswerNo));
					if(res==0){
						$("#ansAnsView"+ptLbrtyBbscttAnswerNo).hide();
					}
				}
			}); */
		}
	});
	
}

var lbrtyBbscttNo = "${detail.lbrtyBbscttNo}";
//댓글 관련
let data = {
	"lbrtyBbscttNo" : lbrtyBbscttNo
}
// 댓글 조회
listAns();
function listAns(){
	$.ajax({
		url:"/lbrtybbsctt/listAns",
		type:"post",
		data:JSON.stringify(data),
		contentType:"application/json;charset=utf-8",
		dataType:"json",
		success:function(res){
			console.log("result : ",res);
			
			let str = "";
			$("#ansRes").html("");
			
			//res : LbrtyBbscttAnswerVO
			$.each(res,function(idx,LbrtyBbscttAnswerVO){
				console.log(displayedAt(0010812433000));
				
				str+=`
				
				<div class="gams\${idx}">
				<div class="dropdown">
				<button class="btn dropdown" type="button" style="float: right;"
					id="dropdownMenuButton1" data-bs-toggle="dropdown"
					aria-expanded="false"><b>⋮</b> 
				</button>
				<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
					<li><a class="dropdown-item" href="javacsript:void(0);" onclick="udtAns(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo});" >수정</a></li>
					<li><a class="dropdown-item" href="javacsript:void(0);" onclick="delAns(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo});">삭제</a></li>
				</ul>
				</div>
				<a style="display:none;">댓글번호 : <span class="gam\${idx}">\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}</span></a><br>
				<b>\${LbrtyBbscttAnswerVO.userNcnm} (\${LbrtyBbscttAnswerVO.userId})</b> <small>&nbsp&nbsp\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerWrDt}</small><br>
				<textarea name="lbrtyBbscttCn" id="lbrtyBbscttAnswerCn\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" class="form-control" 
				readonly rows="1" cols="50" 
				style="border: none" >\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerCn}</textarea>
				<button type="button" class="btn btn-block" style="width:2.5cm; display:none;"
					id="ansUdt\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}">등록</button>
				
				<button type="button" class="btn btn-block" style="width:2.5cm; display:block;"
					id="ansInt2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" 
					name="ansInt2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
					onclick="ansAnsInt(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo});">답글 </button>
				<div id="ansAns\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" style="display:none;">
					<textarea class="form-control"
					style="border: none" id="lbrtyBbscttAnswerCn2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
					name="lbrtyBbscttAnswerCn2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
					rows="1" cols="50" placeholder="답글을 입력해주세요..."></textarea>
					<button type="button" class="btn" style="width:2.5cm;"
						id="ansInt3\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
						name="ansInt3\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
						>등록</button>
					<button type="button" class="btn" style="width:2.5cm;"
						id="cnsInt\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
						name="cnsInt\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
						onclick="cnsInt(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo});">취소</button>
				</div>
					<div id="ansAnsView\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}">
						<button type="button" class="btn" style="width:4cm;"
							id="ansAnsViewBtn\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" 
							name="ansAnsViewBtn\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
							onclick="ansAnsViewBtn(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo})">
							답글 보기</button>
						<button type="button" class="btn" style="width:4cm; display:none;"
							id="ansAnsViewBtn2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" 
							name="ansAnsViewBtn2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}">
							답글 보기 </button>
						<div id="ansAnsView2\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}"
						style="display:none;">
						</div>
					</div>
				</div>
				
				<hr>
				`; 
				ansAnsCnt(`\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}`)
			})
			$("#ansRes").append(str);
		}
	});
	}

//답글 달기
function ansAnsInt(no){
	console.log(no);
	$("#ansInt2"+no).hide();
	$("#ansAns"+no).show();
	//여기서 최초 날린 값만 추가가 되게 하면 된다.
	// 해당 버튼에 대한 클릭 이벤트 핸들러를 한 번만 바인딩
	$("#ansInt3"+no).off("click").on("click",function(){
		let lbrtyBbscttAnswerCn = $("#lbrtyBbscttAnswerCn2"+no).val();
		console.log($("#lbrtyBbscttAnswerCn2"+no).val());
		//여기서 이벤트가 계속 누적이 됨.
		if(lbrtyBbscttAnswerCn=="") {
		alert("내용이 없으면 등록이 불가합니다..");
		return;
	};
		
		let data = {
				/* $(세션이름.id 또는 닉네임) */
				"lbrtyBbscttNo":lbrtyBbscttNo,
				"lbrtyBbscttAnswerCn":lbrtyBbscttAnswerCn,
				"ptLbrtyBbscttAnswerNo":no,
				"ptLbrtyBbscttNo":lbrtyBbscttNo,
			}
		console.log("data : ",data)
		
		$.ajax({
			url:"/lbrtybbsctt/ansAnsInt",
			type:"post",
			data:JSON.stringify(data),
			contentType:"application/json;charset=utf-8",
			dataType:"text",
			success:function(res){
				console.log("res : ",res);
				console.log("no : ",no);
				$("#lbrtyBbscttAnswerCn2"+no).val("");
				ansAnsCnt(no);
				ansAnsViewBtn(no);
				
			}
		});
	});
};
//답글 달기 취소
function cnsInt(no){
	$("#ansAns"+no).hide();
	$("#ansInt2"+no).show();
	$("lbrtyBbscttAnswerCn2"+no).html("");
	
};

//답글 보기
function ansAnsViewBtn(no){
	console.log(no);
	$("#ansAnsViewBtn"+no).hide();
	$("#ansAnsViewBtn2"+no).show();
	$("#ansAnsView2"+no).show();
	
		//console.log("돨까요?");
	$("#ansAnsViewBtn2"+no).on("click",function(){
		$("#ansAnsViewBtn"+no).show();
		$("#ansAnsViewBtn2"+no).hide();
		$("#ansAnsView2"+no).hide();
	});
	
	
	console.log("data",data)
	listAnsans()
	function listAnsans(){
		let data = {
				/* $(세션이름.id 또는 닉네임) */
				//"lbrtyBbscttNo":lbrtyBbscttNo,
				"ptLbrtyBbscttAnswerNo":no,
				//"ptLbrtyBbscttNo":lbrtyBbscttNo,
				
			}
	$.ajax({
		url:"/lbrtybbsctt/ansAnsView",
		type:"post",
		data:JSON.stringify(data),
		contentType:"application/json;charset=utf-8",
		dataType:"json",
		success:function(res){
			console.log("res : ", res);
			
			let str = "";
			$("#ansAnsView2"+no).html("");
			$.each(res,function(idx,LbrtyBbscttAnswerVO){
				str+=`
					<div id="ansAnsView3\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}">
					<div class="dropdown">
					<button class="btn dropdown" type="button" style="float: right;"
						id="dropdownMenuButton1" data-bs-toggle="dropdown"
						aria-expanded="false"><b>⋮</b></button>
					<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
						<li><a class="dropdown-item" href="javacsript:void(0);" onclick="udtAnsans(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo});" >수정</a></li>
						<li><a class="dropdown-item" href="javacsript:void(0);" onclick="delAnsans(\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo},\${no});">삭제</a></li>
					</ul>
					</div>
						<a style="display:none;">댓글번호 : <span class="gam\${idx}">\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}</span></a><br>
						<b>\${LbrtyBbscttAnswerVO.userNcnm} (\${LbrtyBbscttAnswerVO.userId})</b> <small>&nbsp;&nbsp;\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerWrDt}</small><br>
						<textarea name="lbrtyBbscttCn" id="lbrtyBbscttAnswerCn\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}" class="form-control" 
						readonly rows="1" cols="50" 
						style="border: none" >\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerCn}</textarea>
						<button type="button" class="btn btn-block" style="width:2.5cm; display:none;"
							id="ansUdt\${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerNo}">등록</button>
						
					</div>
					`
			});
			$("#ansAnsView2"+no).append(str);
		}
		
	});
	}
	
	
	
};



$(function(){
	//파일 업로드시 파일 이름 읽기
	/* const input = document.getElementById('uploadFile')
	const output = document.getElementById('output')

	document.getElementById("uploadFile").addEventListener('input', (event) => {
	  const files = event.target.files
	  output.innerHTML = Array.from(files).map(file => file.name).join("<br>");
	}) */
	// 댓글 달기 
	$("#ansInt").on("click",function(){
		console.log("하요");
		
		let lbrtyBbscttAnswerCn = $("#lbrtyBbscttAnswerCn").val();
		let data = {
			"lbrtyBbscttAnswerCn":lbrtyBbscttAnswerCn,
			"lbrtyBbscttNo" : lbrtyBbscttNo
		}
		console.log("data",data)
		$.ajax({
			url:"/lbrtybbsctt/insertAns",
			type:"post",
			data:JSON.stringify(data),
			contentType:"application/json;charset=utf-8",
			dataType:"text",
			success:function(res){
				console.log("result : ",res);
				
				$("#lbrtyBbscttAnswerCn").val("");
				listAns();
				/* let str = "";
				$("#ansRes").html("");
				
				//res : LbrtyBbscttAnswerVO
				$.each(res,function(idx,LbrtyBbscttAnswerVO){
					str+=`
					<a>작성자 : \${LbrtyBbscttAnswerVO.userNcnm} (\${LbrtyBbscttAnswerVO.userId})</a><br>
					<a>내용 : \${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerCn}</a><br>
					<a>작성일자 : \${LbrtyBbscttAnswerVO.lbrtyBbscttAnswerWrDt} </a>
					<button type="button" class="btn btn-block" style="width:2.5cm;"
						id="ansInt2" name="ansInt2">답글 </button>
					<div class="input-group-append" id="ansans" style="display:none;">
					<br><br>
					<textarea class="form-control" 
					style="border: none" id="lbrtyBbscttAnswerCn" name="lbrtyBbscttAnswerCn"
					rows="1" placeholder="답글을 입력해주세요..."></textarea>
					<button type="button" class="btn btn-block" style="width:2.5cm;"
					id="ansInt3" name="ansInt3">등록</button>
					</div>
					<hr>
					`;  */
				//})
				//$("#ansRes").append(str);
				
			}
		});
		
		
		
	});
	
	//댓글 끝
	
		
	
	console.log("개똥이");
	
	$(".ck-blurred").keydown(function(){
		console.log("str : " + window.editor.getData());
		
		$("#lbrtyBbscttCn").val(window.editor.getData());
	});
	
	$(".ck-blurred").on("focusout",function(){
		$("#lbrtyBbscttCn").val(window.editor.getData());
	});
	
	//게시글 수정
	$("#bbsUdt").on("click",function(){
		console.log("난 수정을 하겠다.");
		$(".fileDelBtn").css("display","block");
		$("#fileIns").show();
		$("#fileTitle").html("첨부파일 목록 수정");
		
		
		
		$("#cncn").hide();
		$("#ansView").hide();
		$("#ckCn").show();
		$("#lbrtyBbscttSj").attr("readonly", false);
		
		$("#lbrtyBbscttCn").val();
		$("#lbrtybbsCns").on("click",function(){
			console.log("까궁");
			window.location.reload();
		});
		$("#lbrtybbsUdt").on("click",function(){
			let lbrtyBbscttCn = $("#lbrtyBbscttCn").val();
			let lbrtyBbscttSj = $("#lbrtyBbscttSj").val();
			let data = {
				"lbrtyBbscttNo":lbrtyBbscttNo,
				"lbrtyBbscttSj":lbrtyBbscttSj,
				"lbrtyBbscttCn":lbrtyBbscttCn
			} 
			console.log(data);
			$.ajax({
				url:"/lbrtybbsctt/bbsUpdate",
				type:"post",
				data:JSON.stringify(data),
				contentType:"application/json;charset=utf-8",
				dataType:"text",
				success:function(res){
					console.log(res)
					window.location.reload();
				}
			});
		});
		
		
		//$("#").attr("readonly", false);
		
		//게시글 수정시 가능한것, 제목, 내용, 첨부파일
		
		
	});
	
	//게시글 삭제
	$("#bbsDel").on("click",function(){
		console.log("난 삭제를 하겠다.");
		console.log(lbrtyBbscttNo);
		var con = confirm("정말로 삭제하시겠습니까?");
		
		console.log(con);
		
		if(!con) return;
		
		console.log("취소 누르면 실행되면 안돼")
		
		let data = {
			"lbrtyBbscttNo":lbrtyBbscttNo
		}
		$.ajax({
			url:"/lbrtybbsctt/bbsDelete",
			type:"post",
			data:JSON.stringify({
					"lbrtyBbscttNo":lbrtyBbscttNo
				}),
			dataType:"text",
			contentType:"application/json;charset=utf-8",
			success:function(res){
				console.log(res)
				window.location.href = "/lbrtybbsctt/read2"
			}
		});
	});
});
</script>
<div class="card card-primary">
	<%-- ${detail} --%>
	<button type="button" class="btn btn-block btn-secondary btn-sm w-25"
		id="bbsUdt">수정</button>
	<button type="button" class="btn btn-block btn-secondary btn-sm w-25"
		id="bbsDel">삭제</button>
	<div class="card-header">
		<h3 class="card-title">게시글 상세보기</h3>
	</div>



	<!-- 
	요청URI : /stud/create?register
	요청파라미터 : {studId=a001,studNm=개똥이,studPw=java,studDet=학생상세내용
				,gender=여성,nationality=korea,postNum=12345,studAddress=대전 중구
				,studAddress2=123-33}
	파람즈 : register
	요청방식 : post
	 -->
	<form name="frm" id="frm" action="/lbrtybbsctt/create" method="post"
		enctype="multipart/form-data">
		<div class="card-body">
			<div class="form-group">
				<label for="userId">작성자 아이디</label> <input type="text" name="userId"
					class="form-control" id="userId" placeholder="작성자 아이디" required
					readonly
					style="border: none; border-right: 0px; border-top: 0px; boder-left: 0px; boder-bottom: 0px;"
					value="${detail.userId}" />
			</div>
			<div class="form-group">
				<label for="lbrtyBbscttSj">게시글 제목</label> <input type="text"
					name="lbrtyBbscttSj" class="form-control" id="lbrtyBbscttSj"
					placeholder="게시글 제목" required readonly
					style="border: none; border-right: 0px; border-top: 0px; boder-left: 0px; boder-bottom: 0px;"
					value="${detail.lbrtyBbscttSj}" />
			</div>
			
			<div>
<%-- 			<br><br>${sprList}<br><br> --%>
			<a id="fileTitle">첨부파일 목록</a>
			<br>
			<c:forEach var="sprList" items="${sprList}" 
            varStatus="stat">
            <%-- ${sprList.sprviseAtchmnflNo}
            ${sprList.atchmnflNo} --%>
            <br><a id="fileDel${stat.count}">${sprList.atchmnflNm}<button class="fileDelBtn" onclick="fileDel(`${sprList.sprviseAtchmnflNo}`,`${sprList.atchmnflNo}`,`${stat.count}`)" style="display:none;" type="button">x</button></a>
<%--                      <tr onclick="location.href='/lbrtybbsctt/detail?lbrtyBbscttNo=${lbrtyBbscttList.lbrtyBbscttNo}'" style="cursor:hand"> --%>
            </c:forEach>
			</div>
			
			<br>
			<div id="fileIns" class="form-group" style="display:none;">
				<label for="uploadFile">첨부 파일 추가</label>
				<div class="custom-file">
					<input type="file" name="files" multiple="multiple" onchange="test(this.files)">
					<div id="file-list"></div>
				</div>
			</div>

			<div class="form-group">
				<hr>
				<label for="lbrtyBbscttCn"></label>
				<div id="lbrtyBbscttCn">${detail.lbrtyBbscttCn}</div>
				<textarea name="lbrtyBbscttCn" id="lbrtyBbscttCn"
					class="form-control" readonly rows="4" style="display: none;"></textarea>
				<div class="form-group" id="ckCn" style="display: none;">
					<label for="lbrtyBbscttCn2">게시글 내용</label>
					<div id="cklbrtyBbscttCn" style="height: 150px;">${detail.lbrtyBbscttCn}</div>
					<textarea name="lbrtyBbscttCn2" id="lbrtyBbscttCn2"
						class="form-control" rows="4" style="display: none;"></textarea>
					<button type="button"
						class="btn btn-block btn-secondary btn-sm w-25" id="lbrtybbsUdt">수정</button>
					<button type="button"
						class="btn btn-block btn-secondary btn-sm w-25" id="lbrtybbsCns">취소</button>
				</div>
			</div>
		</div>

		<div class="card-footer">
			<button type="submit" class="btn btn-primary" style="display: none;">등록</button>
			<button type="reset" class="btn btn-secondary" style="display: none;">초기화</button>
		</div>
		<%-- <sec:csrfInput/> --%>
	</form>
	<div id="ansView">
		<!--====================== 댓글 시작============================== -->
		<!-- 드롭다운 -->
		<!-- 드롭다운 끝 -->
		<br> <br>
		<div class="col-sm-6">

			<div class="form-group">
				<div>
					<textarea class="form-control" style="border: none"
						id="lbrtyBbscttAnswerCn" name="lbrtyBbscttAnswerCn" rows="1"
						cols="100" placeholder="댓글을 입력해주세요..."></textarea>
					<button type="button" class="btn btn-block" style="width: 2.5cm;"
						id="ansInt" name="ansInt">등록</button>
				</div>
				<hr>
				<div id="ansRes"></div>
			</div>
		</div>

		<!--====================== 댓글 끝============================== -->
	</div>
	<script type="text/javascript">
ClassicEditor
 .create(document.querySelector('#cklbrtyBbscttCn'),
		{ckfinder:{uploadUrl:'/upload/uploads?${_csrf.parameterName}=${_csrf.token}'}})
 .then(editor=>{window.editor=editor;})
 .catch(err=>{console.error(err.stack);});

</script>